const TradingBotMarketAdapter = require('./real_market_adapter');

/**
 * ðŸ§ª TEST REALNYCH DANYCH DLA BOTA
 */
async function testRealMarketData() {
    console.log('ðŸ§ª TESTING REAL MARKET DATA FOR TRADING BOT');
    console.log('===========================================');
    
    const adapter = new TradingBotMarketAdapter({
        symbol: 'BTCUSDT',
        interval: '1m'
    });
    
    try {
        // Initialize adapter
        await adapter.initialize();
        
        if (!adapter.isReady()) {
            console.log('âŒ Adapter not ready');
            return;
        }
        
        // Test data retrieval
        setInterval(() => {
            const marketData = adapter.getMarketData();
            const currentPrice = adapter.getCurrentPrice();
            const latestCandle = marketData[marketData.length - 1];
            
            console.log('ðŸ“Š REAL MARKET DATA FOR ML:', {
                symbol: latestCandle.symbol,
                currentPrice: currentPrice,
                candleCount: marketData.length,
                latestCandle: {
                    open: latestCandle.open,
                    high: latestCandle.high,
                    low: latestCandle.low,
                    close: latestCandle.close,
                    timestamp: new Date(latestCandle.timestamp).toISOString()
                }
            });
            
        }, 10000); // Every 10 seconds
        
        console.log('âœ… Real market data test running...');
        
    } catch (error) {
        console.error('âŒ Test failed:', error.message);
    }
}

// Graceful shutdown
process.on('SIGINT', () => {
    console.log('\nðŸ›‘ Shutting down test...');
    process.exit(0);
});

// Start test
if (require.main === module) {
    testRealMarketData();
}
