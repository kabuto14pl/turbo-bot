@startuml DeploymentDiagram

!define CLOUD_COLOR #E3F2FD
!define CONTAINER_COLOR #F3E5F5
!define SERVICE_COLOR #E8F5E8
!define DATABASE_COLOR #FFF3E0

skinparam node {
    BackgroundColor CLOUD_COLOR
    BorderColor #1565C0
}

skinparam component {
    BackgroundColor SERVICE_COLOR
    BorderColor #2E7D32
}

title **Production Deployment Architecture - 2025 Enterprise**

cloud "AWS/Azure Cloud" {
    
    node "Load Balancer\n(Application Gateway)" as LB {
        component "SSL/TLS Termination" as SSL
        component "Rate Limiting" as RL
        component "Health Checks" as HC
    }
    
    node "Kubernetes Cluster" as K8S {
        
        package "Trading Bot Pods" <<CONTAINER_COLOR>> {
            component "Trading Bot\nReplica 1" as TB1
            component "Trading Bot\nReplica 2" as TB2  
            component "Trading Bot\nReplica 3" as TB3
        }
        
        package "Kafka Cluster" <<CONTAINER_COLOR>> {
            component "Kafka Broker 1" as KB1
            component "Kafka Broker 2" as KB2
            component "Kafka Broker 3" as KB3
            component "Zookeeper" as ZK
        }
        
        package "ML Services" <<CONTAINER_COLOR>> {
            component "TensorFlow Serving\n(Model v2.15)" as TF
            component "Ray Cluster\n(Distributed Optimization)" as RAY
            component "Model Registry\n(MLflow)" as MR
        }
        
        package "Monitoring Stack" <<CONTAINER_COLOR>> {
            component "Prometheus\n(Metrics)" as PROM
            component "Grafana\n(Dashboards)" as GRAF
            component "Jaeger\n(Tracing)" as JAEG
            component "ELK Stack\n(Logging)" as ELK
        }
    }
    
    node "Database Tier" as DB_TIER {
        database "DuckDB\n(Analytics)" as DUCK <<DATABASE_COLOR>>
        database "Redis\n(Cache)" as REDIS <<DATABASE_COLOR>>
        database "PostgreSQL\n(Metadata)" as POSTGRES <<DATABASE_COLOR>>
    }
    
    node "External Services" as EXT {
        component "Binance API\n(Market Data)" as BINANCE
        component "HashiCorp Vault\n(Secrets)" as VAULT
        component "PagerDuty\n(Alerting)" as PAGER
    }
}

' Network connections
LB --> TB1 : HTTPS/8080
LB --> TB2 : HTTPS/8080  
LB --> TB3 : HTTPS/8080

TB1 --> KB1 : TCP/9092
TB2 --> KB2 : TCP/9092
TB3 --> KB3 : TCP/9092

KB1 --> ZK : TCP/2181
KB2 --> ZK : TCP/2181  
KB3 --> ZK : TCP/2181

TB1 --> TF : HTTP/8501
TB2 --> TF : HTTP/8501
TB3 --> TF : HTTP/8501

TB1 --> DUCK : TCP/5432
TB2 --> DUCK : TCP/5432
TB3 --> DUCK : TCP/5432

TB1 --> REDIS : TCP/6379
TB2 --> REDIS : TCP/6379
TB3 --> REDIS : TCP/6379

PROM --> TB1 : HTTP/9090
PROM --> TB2 : HTTP/9090  
PROM --> TB3 : HTTP/9090

GRAF --> PROM : HTTP/9090
ELK --> TB1 : TCP/5044
ELK --> TB2 : TCP/5044
ELK --> TB3 : TCP/5044

TB1 --> BINANCE : HTTPS/443
TB2 --> BINANCE : HTTPS/443
TB3 --> BINANCE : HTTPS/443

TB1 --> VAULT : HTTPS/8200
TB2 --> VAULT : HTTPS/8200
TB3 --> VAULT : HTTPS/8200

PROM --> PAGER : HTTPS/443

' Resource specifications
note top of TB1
**Trading Bot Specs:**
• CPU: 4 cores
• Memory: 8GB RAM
• Disk: 50GB SSD
• Network: 10Gbps
• Replicas: 3 (HA)
end note

note top of KB1
**Kafka Specs:**
• CPU: 8 cores  
• Memory: 16GB RAM
• Disk: 500GB NVMe SSD
• Network: 25Gbps
• Partitions: 12 per topic
end note

note top of TF
**ML Services:**
• GPU: NVIDIA V100
• CPU: 16 cores
• Memory: 32GB RAM
• Models: LSTM/CNN/Transformer
• Inference: <5ms latency
end note

note top of DUCK
**DuckDB Analytics:**
• CPU: 32 cores
• Memory: 128GB RAM  
• Disk: 2TB NVMe SSD
• Compression: 10x ratio
• Query speed: <100ms
end note

note bottom of K8S
**Infrastructure as Code:**
• Terraform deployment
• Helm charts for services
• GitOps with ArgoCD
• Auto-scaling (HPA/VPA)
• Multi-AZ deployment
end note

note bottom of EXT
**Security & Compliance:**
• TLS 1.3 encryption
• GDPR data protection
• SOC 2 compliance
• Zero-trust networking
• Automated backups
end note

@enduml
