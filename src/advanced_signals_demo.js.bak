"use strict";
/**
 * ðŸš€ ADVANCED REAL-TIME TRADING SIGNALS - DEMO & TEST
 *
 * Demonstration i testy systemu sygnaÅ‚Ã³w w czasie rzeczywistym
 */
Object.defineProperty(exports, "__esModule", { value: true });
const advanced_realtime_trading_signals_1 = require("./advanced_realtime_trading_signals");
async function runAdvancedSignalsDemo() {
    console.log('ðŸš€ Advanced Real-Time Trading Signals Demo');
    console.log('='.repeat(60));
    try {
        // Create signal system
        const signalSystem = new advanced_realtime_trading_signals_1.AdvancedRealTimeTradingSignals({
            symbols: ['BTCUSDT', 'ETHUSDT', 'ADAUSDT', 'SOLUSDT'],
            reconnectDelay: 3000
        });
        // Set up event listeners
        signalSystem.on('signal', (signal) => {
            console.log(`\nðŸŽ¯ NEW SIGNAL GENERATED:`);
            console.log(`ðŸ“Š Symbol: ${signal.symbol}`);
            console.log(`ðŸ“ˆ Direction: ${signal.direction}`);
            console.log(`ðŸ’ª Strength: ${(signal.strength * 100).toFixed(1)}%`);
            console.log(`ðŸŽ–ï¸ Confidence: ${(signal.confidence * 100).toFixed(1)}%`);
            console.log(`â° Timeframe: ${signal.timeframe}`);
            console.log(`ðŸ” Source: ${signal.source}`);
            console.log(`âš ï¸ Risk Level: ${signal.metadata.riskLevel}`);
            console.log(`ðŸ’° Expected Return: ${(signal.metadata.expectedReturn * 100).toFixed(2)}%`);
            if (signal.metadata.indicators) {
                console.log(`ðŸ“‹ Indicators:`, Object.keys(signal.metadata.indicators).length, 'metrics');
            }
        });
        signalSystem.on('started', () => {
            console.log('\nâœ… Advanced Trading Signals System STARTED!');
            console.log('ðŸ“¡ WebSocket connections active');
            console.log('ðŸ§  ML models loaded and ready');
            console.log('ðŸŽ¯ Signal generation active');
        });
        signalSystem.on('stopped', () => {
            console.log('\nðŸ›‘ Advanced Trading Signals System STOPPED');
        });
        // Start the system
        console.log('\nðŸ”„ Starting Advanced Real-Time Trading Signals...');
        await signalSystem.start();
        // Monitor system for 2 minutes
        console.log('\nðŸ“Š Monitoring signals for 2 minutes...');
        let signalCount = 0;
        const originalSignalHandler = signalSystem.listenerCount('signal');
        signalSystem.on('signal', () => signalCount++);
        setTimeout(() => {
            console.log('\nðŸ“ˆ DEMO SUMMARY:');
            console.log(`ðŸŽ¯ Total signals generated: ${signalCount}`);
            console.log(`ðŸ“Š Active signals: ${signalSystem.getActiveSignals().length}`);
            console.log(`ðŸ”§ System active: ${signalSystem.isSystemActive()}`);
            // Show performance metrics
            const performance = signalSystem.getPerformanceMetrics();
            console.log(`ðŸ“‹ Signal sources tracked: ${performance.size}`);
            for (const [source, metrics] of performance) {
                console.log(`\nðŸ“Š ${source.toUpperCase()}:`);
                console.log(`   Accuracy: ${(metrics.accuracy * 100).toFixed(1)}%`);
                console.log(`   Win Rate: ${(metrics.winRate * 100).toFixed(1)}%`);
                console.log(`   Avg Return: ${(metrics.avgReturn * 100).toFixed(2)}%`);
                console.log(`   Reliability: ${(metrics.reliability * 100).toFixed(1)}%`);
            }
            // Stop the system
            signalSystem.stop();
        }, 120000); // 2 minutes
        // Show active signals every 30 seconds
        setInterval(() => {
            const activeSignals = signalSystem.getActiveSignals();
            console.log(`\nðŸ“Š Active Signals: ${activeSignals.length}`);
            activeSignals.forEach(signal => {
                const age = (Date.now() - signal.timestamp) / 1000;
                console.log(`   ${signal.symbol} ${signal.direction} (${age.toFixed(0)}s ago, ${(signal.confidence * 100).toFixed(1)}%)`);
            });
        }, 30000);
    }
    catch (error) {
        console.error('âŒ Error in Advanced Signals Demo:', error);
    }
}
// Mock WebSocket for testing (since we don't have real WebSocket in this environment)
if (typeof WebSocket === 'undefined') {
    console.log('ðŸ”§ Setting up mock WebSocket for testing...');
    global.WebSocket = class MockWebSocket {
        constructor(url) {
            console.log(`ðŸ“¡ Mock WebSocket connecting to: ${url}`);
            // Simulate connection
            setTimeout(() => {
                if (this.onopen)
                    this.onopen();
                // Send mock data every 5 seconds
                this.startMockData();
            }, 1000);
        }
        startMockData() {
            const symbols = ['BTCUSDT', 'ETHUSDT', 'ADAUSDT', 'SOLUSDT'];
            setInterval(() => {
                const symbol = symbols[Math.floor(Math.random() * symbols.length)];
                const price = 50000 + Math.random() * 10000;
                const volume = 100 + Math.random() * 1000;
                const mockData = {
                    e: '24hrTicker',
                    E: Date.now(),
                    s: symbol,
                    c: price.toString(),
                    v: volume.toString(),
                    b: (price - 1).toString(),
                    a: (price + 1).toString(),
                    P: ((Math.random() - 0.5) * 10).toString(),
                    h: (price + Math.random() * 100).toString(),
                    l: (price - Math.random() * 100).toString()
                };
                if (this.onmessage) {
                    this.onmessage({ data: JSON.stringify(mockData) });
                }
            }, 3000 + Math.random() * 2000); // Every 3-5 seconds
        }
        close() {
            console.log('ðŸ“¡ Mock WebSocket closed');
            if (this.onclose)
                this.onclose();
        }
    };
}
// Run the demo
if (require.main === module) {
    runAdvancedSignalsDemo().catch(console.error);
}
